angular.module("angular.prime").directive("puiRating",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,d,e){e&&$(function(){function f(){e.$viewValue!==parseInt(b.val())&&e.$setViewValue(b.val())}var c=a.$eval(d.puiRating)||{};c.cancel=void 0!==c.cancel?c.cancel:!0;c.stars=c.stars||5;b.puirating({cancel:c.cancel,stars:c.stars});b.hide();e.$render=function(){b.puirating("setValue",e.$viewValue)};b.bind("puiratingrate puiratingcancel",function(){a.safeApply(f());c.callback&&c.callback(e.$viewValue)});
d.ngDisabled&&a.$watch(d.ngDisabled,function(a){!1===a?$(function(){b.puirating("enable")}):$(function(){b.puirating("disable")})})})}}});$(function(){$.widget("primeui.puirating",{options:{stars:5,cancel:!0},_create:function(){var a=this.element;a.wrap("<div />");this.container=a.parent();this.container.addClass("pui-rating");var b=a.val(),b=""==b?null:parseInt(b);this.options.cancel&&this.container.append('<div class="pui-rating-cancel"><a></a></div>');for(var d=0;d<this.options.stars;d++)this.container.append('<div class="'+(b>d?"pui-rating-star pui-rating-star-on":"pui-rating-star")+'"><a></a></div>');this.stars=this.container.children(".pui-rating-star");
a.prop("disabled")?this.container.addClass("ui-state-disabled"):a.prop("readonly")||this._bindEvents()},_bindEvents:function(){var a=this;this.stars.on("click",function(){var b=a.stars.index(this)+1;a.setValue(b)});this.container.children(".pui-rating-cancel").hover(function(){$(this).toggleClass("pui-rating-cancel-hover")}).click(function(){a.cancel()})},cancel:function(){this.element.val("");this.stars.filter(".pui-rating-star-on").removeClass("pui-rating-star-on");this._trigger("cancel",null)},
getValue:function(){var a=this.element.val();return""==a?null:parseInt(a)},setValue:function(a){this.element.val(a);this.stars.removeClass("pui-rating-star-on");for(var b=0;b<a;b++)this.stars.eq(b).addClass("pui-rating-star-on");this._trigger("rate",null,a)},enable:function(){this.container.removeClass("ui-state-disabled");this._bindEvents()},disable:function(){this.container.addClass("ui-state-disabled");this._unbindEvents()},_unbindEvents:function(){this.stars.off("click");this.container.children(".pui-rating-cancel").hover(function(){}).click(function(){})}})});