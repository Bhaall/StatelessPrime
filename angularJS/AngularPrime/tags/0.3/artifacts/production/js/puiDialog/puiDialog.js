angular.module("angular.prime").directive("puiDialog",function(){return{restrict:"A",compile:function(){return function(b,c,d){var a=b.$eval(d.puiDialog)||{};if("boolean"!=typeof a.dlgVisible)throw Error("The options object "+d.puiDialog+" needs a boolean property dlgVisible");a.draggable=void 0!==a.draggable?a.draggable:!0;a.modal=void 0!==a.modal?a.modal:!0;a.closable=void 0!==a.closable?a.closable:!0;a.location=a.location||"center";a.height=a.height||"auto";a.width=a.width||"300px";a.minWidth=
a.minWidth||150;a.minHeight=a.minHeight||25;a.resizable=void 0!==a.resizable?a.resizable:!1;a.showEffect=a.showEffect||"fade";a.hideEffect=a.hideEffect||"fade";a.effectSpeed=a.effectSpeed||"normal";a.closeOnEscape=void 0!==a.closeOnEscape?a.closeOnEscape:!0;a.minimizable=void 0!==a.minimizable?a.minimizable:!1;a.maximizable=void 0!==a.maximizable?a.maximizable:!1;$(function(){c.puidialog({draggable:a.draggable,resizable:a.resizable,location:a.location,minWidth:a.minWidth,minHeight:a.minHeight,height:a.height,
width:a.width,modal:a.modal,showEffect:a.showEffect,hideEffect:a.hideEffect,effectSpeed:a.effectSpeed,closeOnEscape:a.closeOnEscape,closable:a.closable,minimizable:a.minimizable,maximizable:a.maximizable})});b.$watch(d.puiDialog+".dlgVisible",function(a){!1===a?$(function(){c.puidialog("hide")}):$(function(){c.puidialog("show")})});c.bind("puidialogafterhide",function(){b.$apply(function(){b[d.puiDialog].dlgVisible=!1})})}}}});$(function(){$.widget("primeui.puidialog",{options:{draggable:!0,resizable:!0,location:"center",minWidth:150,minHeight:25,height:"auto",width:"300px",visible:!1,modal:!1,showEffect:null,hideEffect:null,effectOptions:{},effectSpeed:"normal",closeOnEscape:!0,rtl:!1,closable:!0,minimizable:!1,maximizable:!1,appendTo:null,buttons:null},_create:function(){this.element.addClass("pui-dialog ui-widget ui-widget-content ui-helper-hidden ui-corner-all pui-shadow").contents().wrapAll('<div class="pui-dialog-content ui-widget-content" />');
this.element.prepend('<div class="pui-dialog-titlebar ui-widget-header ui-helper-clearfix ui-corner-top"><span id="'+this.element.attr("id")+'_label" class="pui-dialog-title">'+this.element.attr("title")+"</span>").removeAttr("title");if(this.options.buttons){this.footer=$('<div class="pui-dialog-buttonpane ui-widget-content ui-helper-clearfix"></div>').appendTo(this.element);for(var b=0;b<this.options.buttons.length;b++){var c=this.options.buttons[b],d=$('<button type="button"></button>').appendTo(this.footer);
c.text&&d.text(c.text);d.puibutton(c)}}this.options.rtl&&this.element.addClass("pui-dialog-rtl");this.content=this.element.children(".pui-dialog-content");this.titlebar=this.element.children(".pui-dialog-titlebar");this.options.closable&&this._renderHeaderIcon("pui-dialog-titlebar-close","ui-icon-close");this.options.minimizable&&this._renderHeaderIcon("pui-dialog-titlebar-maximize","ui-icon-extlink");this.options.minimizable&&this._renderHeaderIcon("pui-dialog-titlebar-minimize","ui-icon-minus");
this.icons=this.titlebar.children(".pui-dialog-titlebar-icon");this.closeIcon=this.titlebar.children(".pui-dialog-titlebar-close");this.minimizeIcon=this.titlebar.children(".pui-dialog-titlebar-minimize");this.maximizeIcon=this.titlebar.children(".pui-dialog-titlebar-maximize");this.blockEvents="focus.puidialog mousedown.puidialog mouseup.puidialog keydown.puidialog keyup.puidialog";this.parent=this.element.parent();this.element.css({width:this.options.width,height:"auto"});this.content.height(this.options.height);
this._bindEvents();this.options.draggable&&this._setupDraggable();this.options.resizable&&this._setupResizable();this.options.appendTo&&this.element.appendTo(this.options.appendTo);0==$(document.body).children(".pui-dialog-docking-zone").length&&$(document.body).append('<div class="pui-dialog-docking-zone"></div>');this._applyARIA();this.options.visible&&this.show()},_renderHeaderIcon:function(b,c){this.titlebar.append('<a class="pui-dialog-titlebar-icon '+b+' ui-corner-all" href="#" role="button"><span class="ui-icon '+
c+'"></span></a>')},_enableModality:function(){var b=this,c=$(document);this.modality=$('<div id="'+this.element.attr("id")+'_modal" class="ui-widget-overlay"></div>').appendTo(document.body).css({width:c.width(),height:c.height(),"z-index":this.element.css("z-index")-1});c.bind("keydown.puidialog",function(c){if(c.keyCode==$.ui.keyCode.TAB){var a=b.content.find(":tabbable"),e=a.filter(":first"),a=a.filter(":last");if(c.target===a[0]&&!c.shiftKey)return e.focus(1),!1;if(c.target===e[0]&&c.shiftKey)return a.focus(1),
!1}}).bind(this.blockEvents,function(c){if($(c.target).zIndex()<b.element.zIndex())return!1})},_disableModality:function(){this.modality.remove();this.modality=null;$(document).unbind(this.blockEvents).unbind("keydown.dialog")},show:function(){if(!this.element.is(":visible")){this.positionInitialized||this._initPosition();this._trigger("beforeShow",null);if(this.options.showEffect){var b=this;this.element.show(this.options.showEffect,this.options.effectOptions,this.options.effectSpeed,function(){b._postShow()})}else this.element.show(),
this._postShow();this._moveToTop();this.options.modal&&this._enableModality()}},_postShow:function(){this._trigger("afterShow",null);this.element.attr({"aria-hidden":!1,"aria-live":"polite"});this._applyFocus()},hide:function(){if(!this.element.is(":hidden")){this._trigger("beforeHide",null);if(this.options.hideEffect){var b=this;this.element.hide(this.options.hideEffect,this.options.effectOptions,this.options.effectSpeed,function(){b._postHide()})}else this.element.hide(),this._postHide();this.options.modal&&
this._disableModality()}},_postHide:function(){this._trigger("afterHide",null);this.element.attr({"aria-hidden":!0,"aria-live":"off"})},_applyFocus:function(){this.element.find(":not(:submit):not(:button):input:visible:enabled:first").focus()},_bindEvents:function(){var b=this;this.icons.mouseover(function(){$(this).addClass("ui-state-hover")}).mouseout(function(){$(this).removeClass("ui-state-hover")});this.closeIcon.on("click.puidialog",function(c){b.hide();c.preventDefault()});this.maximizeIcon.click(function(c){b.toggleMaximize();
c.preventDefault()});this.minimizeIcon.click(function(c){b.toggleMinimize();c.preventDefault()});if(this.options.closeOnEscape)$(document).on("keydown.dialog_"+this.element.attr("id"),function(c){var d=$.ui.keyCode,a=parseInt(b.element.css("z-index"))===PUI.zindex;c.which===d.ESCAPE&&(a&&b.element.is(":visible"))&&b.hide()});if(this.options.modal)$(window).on("resize.puidialog",function(){$(document.body).children(".ui-widget-overlay").css({width:$(document).width(),height:$(document).height()})})},
_setupDraggable:function(){this.element.draggable({cancel:".pui-dialog-content, .pui-dialog-titlebar-close",handle:".pui-dialog-titlebar",containment:"document"})},_setupResizable:function(){this.element.resizable({minWidth:this.options.minWidth,minHeight:this.options.minHeight,alsoResize:this.content,containment:"document"});this.resizers=this.element.children(".ui-resizable-handle")},_initPosition:function(){this.element.css({left:0,top:0});if(/(center|left|top|right|bottom)/.test(this.options.location))this.options.location=
this.options.location.replace(","," "),this.element.position({my:"center",at:this.options.location,collision:"fit",of:window,using:function(b){var a=0>b.left?0:b.left,b=0>b.top?0:b.top;$(this).css({left:a,top:b})}});else{var b=this.options.position.split(","),c=$.trim(b[0]),b=$.trim(b[1]);this.element.offset({left:c,top:b})}this.positionInitialized=!0},_moveToTop:function(){this.element.css("z-index",++PUI.zindex)},toggleMaximize:function(){this.minimized&&this.toggleMinimize();if(this.maximized)this.element.removeClass("pui-dialog-maximized"),
this._restoreState(),this.maximizeIcon.removeClass("ui-state-hover").children(".ui-icon").removeClass("ui-icon-newwin").addClass("ui-icon-extlink"),this.maximized=!1;else{this._saveState();var b=$(window);this.element.addClass("pui-dialog-maximized").css({width:b.width()-6,height:b.height()}).offset({top:b.scrollTop(),left:b.scrollLeft()});this.content.css({width:"auto",height:"auto"});this.maximizeIcon.removeClass("ui-state-hover").children(".ui-icon").removeClass("ui-icon-extlink").addClass("ui-icon-newwin");
this.maximized=!0;this._trigger("maximize")}},toggleMinimize:function(){var b=!0,c=$(document.body).children(".pui-dialog-docking-zone");this.maximized&&(this.toggleMaximize(),b=!1);var d=this;this.minimized?(this.element.appendTo(this.parent).removeClass("pui-dialog-minimized").css({position:"fixed","float":"none"}),this._restoreState(),this.content.show(),this.minimizeIcon.removeClass("ui-state-hover").children(".ui-icon").removeClass("ui-icon-plus").addClass("ui-icon-minus"),this.minimized=!1,
this.options.resizable&&this.resizers.show(),this.footer&&this.footer.show()):(this._saveState(),b?this.element.effect("transfer",{to:c,className:"pui-dialog-minimizing"},500,function(){d._dock(c);d.element.addClass("pui-dialog-minimized")}):this._dock(c))},_dock:function(b){this.element.appendTo(b).css("position","static");this.element.css({height:"auto",width:"auto","float":"left"});this.content.hide();this.minimizeIcon.removeClass("ui-state-hover").children(".ui-icon").removeClass("ui-icon-minus").addClass("ui-icon-plus");
this.minimized=!0;this.options.resizable&&this.resizers.hide();this.footer&&this.footer.hide();b.css("z-index",++PUI.zindex);this._trigger("minimize")},_saveState:function(){this.state={width:this.element.width(),height:this.element.height()};var b=$(window);this.state.offset=this.element.offset();this.state.windowScrollLeft=b.scrollLeft();this.state.windowScrollTop=b.scrollTop()},_restoreState:function(){this.element.width(this.state.width).height(this.state.height);var b=$(window);this.element.offset({top:this.state.offset.top+
(b.scrollTop()-this.state.windowScrollTop),left:this.state.offset.left+(b.scrollLeft()-this.state.windowScrollLeft)})},_applyARIA:function(){this.element.attr({role:"dialog","aria-labelledby":this.element.attr("id")+"_title","aria-hidden":!this.options.visible});this.titlebar.children("a.pui-dialog-titlebar-icon").attr("role","button")}})});